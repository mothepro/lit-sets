<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="color-scheme" content="light dark">
  <title>Mo's Sets</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
  <script type="importmap-shim" src="import-map.json"></script>
  <link rel="stylesheet" href="light.css" media="(prefers-color-scheme: light), (prefers-color-scheme: no-preference)">
  <link rel="stylesheet" href="dark.css" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
  <link rel="stylesheet" href="style.css" />
  <!-- Production -->
  <script prod-only type=prod-only-module
    src="//unpkg.com/es-module-shims@0.4.6/dist/es-module-shims.min.js"></script>
  <script prod-only type=prod-only-module-shim src="//unpkg.com/@mothepro/lit-sets/dist/esm/demo/index.js"></script>
  <script prod-only type=prod-only-application/javascript async
    src="https://www.googletagmanager.com/gtag/js?id=UA-172429940-1"></script>
  <!-- Development -->
  <script dev-only type=application/javascript src="//unpkg.com/typescript/lib/typescript.js"></script>
  <script dev-only type=module src="//unpkg.com/@mothepro/es-module-shims@0.0.0/dist/es-module-shims.min.js"></script>
  <script dev-only type=module-shim src="./index.ts"></script>
</head>

<body first-visit theme-toggle-key="theme" first-visit-help-delay="10000">
  <h1 class="title">
    Sets
    <span class="subtitle">by Mo</span>
  </h1>

  <lit-p2p
    fallback
    local-storage
    max-peers="5"
    signaling="wss://ws.parkshade.com:443"
    version="0.3.2"
    timeout="25000"
    lobby="lit-sets@0.0.2"
    stuns='[
      "stun:stun.stunprotocol.org",
      "stun:stun.l.google.com:19302",
      "stun:stun1.l.google.com:19302",
      "stun:stun2.l.google.com:19302",
      "stun:stun3.l.google.com:19302",
      "stun:stun4.l.google.com:19302"
    ]'>
    <div class="loading p2p-default-state">
      <div></div>
      <div></div>
    </div>

    <div slot="p2p-offline" class="loading p2p-offline">
      <div></div>
      <div></div>
    </div>

    <div slot="p2p-loading" class="loading p2p-loading">
      <div></div>
      <div></div>
    </div>

    <div class="top-icons">
      <mwc-button
        raised
        toggle-online-btn
        class="first-visit p2p-disconnected mt6px"
        trailingIcon
        icon="groups"
        label="Play with friends"
      ></mwc-button>
      <mwc-icon-button
        toggle-online-btn
        icon="groups"
        class="not-first-visit p2p-disconnected"
        title="Play with friends"
        label="Play with friends"
      ></mwc-icon-button>
      <mwc-button
        raised
        toggle-online-btn
        class="first-visit p2p-lobby mt6px"
        trailingIcon
        icon="person"
        label="Play solo"
      ></mwc-button>
      <mwc-icon-button
        toggle-online-btn
        icon="person"
        class="not-first-visit p2p-lobby"
        title="Play solo"
        label="Play solo"
      ></mwc-icon-button>
      <mwc-icon-button
        icon="help"
        label="How to Play"
        title="How to Play"
      ></mwc-icon-button>
      <a
        title="Improve this game"
        target="_blank"
        href="https://docs.google.com/forms/d/e/1FAIpQLSfRwls4DV8N1DdDqfx9WMc59OIUep0sMhaY9vT_pUBC4rc-FA/viewform">
        <mwc-icon-button
          icon="feedback"
          label="Send feedback"
        ></mwc-icon-button>
      </a>
      <theme-toggle persistent>
        <mwc-icon-button
          slot="dark"
          icon="brightness_5"
          label="Switch to light theme"
          title="Switch to light theme"
        ></mwc-icon-button>
        <mwc-icon-button
          slot="light"
          icon="nightlight"
          label="Switch to dark theme"
          title="Switch to dark theme"
        ></mwc-icon-button>
      </theme-toggle>
    </div>

    <span class="p2p-lobby next-to-lobby">You're playing as</span>
    <br slot="p2p-lobby" class="p2p-lobby" />

    <p2p-sets slot="p2p-disconnected"></p2p-sets>
    <p2p-sets slot="p2p-ready"></p2p-sets>

    <mwc-dialog heading="How to Play">
      <h2>
         Welcome to Sets by Mo!
      </h2>

      <p>
        An online version of the reflex card game <a href="https://en.wikipedia.org/wiki/Set_(card_game)" target="_blank">Set</a>,
        designed by Marsha Falco in 1974.
      </p>

      <p>The goal is to take all cards on the screen in groups known as sets.</p>

      <p>
        The deck contains 81 cards each one with 4 unique features. These are the color, shape, opacity, and count.
        Here you can see some cards and their features.
      </p>
      
      <div class="card-table">
        <sets-card
          opacity="0"
          color="0"
          shape="0"
          quantity="0"
        ></sets-card>
        <table>
          <tr>
            <th class="key">Feature</th>
            <th class="value">Value</th>
          </tr>
          <tr>
            <td class="key">Count</td>
            <td class="value">1</td>
          </tr>
          <tr>
            <td class="key">Color</td>
            <td class="value">Blue</td>
          </tr>
          <tr>
            <td class="key">Shape</td>
            <td class="value">Square</td>
          </tr>
          <tr>
            <td class="key">Opacity</td>
            <td class="value">Opaque</td>
          </tr>
        </table>

        <sets-card
          opacity="1"
          color="1"
          shape="2"
          quantity="1"
        ></sets-card>
        <table>
          <tr>
            <th class="key">Feature</th>
            <th class="value">Value</th>
          </tr>
          <tr>
            <td class="key">Count</td>
            <td class="value">2</td>
          </tr>
          <tr>
            <td class="key">Color</td>
            <td class="value">Yellow</td>
          </tr>
          <tr>
            <td class="key">Shape</td>
            <td class="value">Triangle</td>
          </tr>
          <tr>
            <td class="key">Opacity</td>
            <td class="value">Translucent</td>
          </tr>
        </table>

        <sets-card
          opacity="2"
          color="2"
          shape="1"
          quantity="2"
        ></sets-card>
        <table>
          <tr>
            <th class="key">Feature</th>
            <th class="value">Value</th>
          </tr>
          <tr>
            <td class="key">Count</td>
            <td class="value">3</td>
          </tr>
          <tr>
            <td class="key">Color</td>
            <td class="value">Red</td>
          </tr>
          <tr>
            <td class="key">Shape</td>
            <td class="value">Circle</td>
          </tr>
          <tr>
            <td class="key">Opacity</td>
            <td class="value">Transparent</td>
          </tr>
        </table>
      </div>

      <p>
        A set is a combination of 3 cards where each of the 4 features are either <b>all the same</b> or <b>all different</b>.
        For example, the three cards shown above form a set, because each feature is expressed in all the cards.
        You can also have sets where some features are different and others are the same.
      </p>
    
      <p>
        In the example blue, the three cards are identical in opacity, <i>solid</i>, and color, <i>blue</i>, while
        being different in count and shape.
      </p>

      <div class="set">
        <sets-card
          color="0"
          quantity="0"
          shape="2"
          opacity="0"
        ></sets-card>
        <sets-card
          color="0"
          quantity="1"
          shape="1"
          opacity="0"
        ></sets-card>
        <sets-card
          color="0"
          quantity="2"
          shape="0"
          opacity="0"
        ></sets-card>
      </div>

      <p>
        However, a group of 3 cards needs to be correct in all four features to be a set. The three cards below do not form a
        set, due to their color. Two of the cards are yellow while the third is red, so the three colors are <b>neither</b>
        all the same, nor all different.
      </p>
      
      <div class="set">
        <sets-card
          color="1"
          quantity="0"
          shape="0"
          opacity="0"
        ></sets-card>
        <sets-card
          color="2"
          quantity="1"
          shape="0"
          opacity="1"
        ></sets-card>
        <sets-card
          color="1"
          quantity="2"
          shape="0"
          opacity="2"
        ></sets-card>
      </div>

      <p>
        When the game starts 12 cards are dealt from the deck. When a player finds a set, they take those 4 cards from the screen,
        and three new cards are dealt to replace the ones that were taken. The game ends when the deck is empty and no more sets are available.
      </p>

      <p>
        Sometimes, there will not be any sets among the 12 cards on screen. In these cases, the game
        will automatically deal out 3 extra cards until a set can be taken.
      </p>

      <p><em>Accessibility</em> is important, so you can also play entirely using your keyboard!</p>
      <ul>
        <li>Press <code>Tab</code> to hightlight the next card.</li>
        <li>Press <code>Shift</code> + <code>Tab</code> to hightlight the previous card.</li>
        <li>Press <code>Space</code> to select the hightlighted card.</li>
        <li>Press <code>Enter</code> to take the selected cards as a set.</li>
      </ul>
    
      <mwc-button raised slot="primaryAction" dialogAction="close">Got it!</mwc-button>
    </mwc-dialog>
  </lit-p2p>
</body>

<script>
  window.dataLayer = window.dataLayer || []
  function gtag() { dataLayer.push(arguments) }
  gtag('js', new Date())
  gtag('config', 'UA-172429940-2')

  document.body.firstElementChild.addEventListener('p2p-error', error => {
    console.error('Lost connection', error)
    ga('send', 'exception', {
      exDescription: `${error.message} -- ${error.stack}`,
      exFatal: false, // idk...
    })
  })
</script>

</html>
